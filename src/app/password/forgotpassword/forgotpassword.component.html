<div class="forgot-password-container">
  <h2>Forgot Password</h2>

  <!-- Step 1: Enter Email -->
  <form *ngIf="!otpSent" (ngSubmit)="sendOtp()">
    <div class="form-group">
      <label>Email:</label>
      <input type="email" [(ngModel)]="email" name="email" required />
    </div>
    <button type="submit">Send OTP</button>
  </form>

  <!-- Step 2: Enter OTP -->
  <form *ngIf="otpSent && !otpVerified" (ngSubmit)="verifyOtp()">
    <div class="form-group">
      <label>Enter OTP:</label>
      <input type="text" [(ngModel)]="otp" name="otp" required />
    </div>
    <button type="submit">Verify OTP</button>
  </form>

  <!-- Step 3: Reset Password -->
<form *ngIf="otpVerified" (ngSubmit)="resetPassword()">
  <div class="form-group">
    <label>New Password:</label>
    <input
      type="password"
      [(ngModel)]="newPassword"
      name="newPassword"
      (input)="validatePassword()"
      (blur)="touched = true"
      required
    />

    <!-- Always visible hint -->
    <small class="hint">
      Must be at least {{ passwordService.policy.minLength }} characters and include uppercase, lowercase, number, special character.
    </small>

    <!-- Error messages after touch -->
    <div class="error" *ngIf="touched && !passwordCriteria.minLength">
      Minimum {{ passwordService.policy.minLength }} characters required.
    </div>
    <div class="error" *ngIf="touched && !passwordCriteria.uppercase">
      Must include at least one uppercase letter.
    </div>
    <div class="error" *ngIf="touched && !passwordCriteria.lowercase">
      Must include at least one lowercase letter.
    </div>
    <div class="error" *ngIf="touched && !passwordCriteria.number">
      Must include at least one number.
    </div>
    <div class="error" *ngIf="touched && !passwordCriteria.specialChar">
      Must include at least one special character.
    </div>
  </div>
  <button type="submit" [disabled]="!isPasswordValid()">Reset Password</button>
</form>

  <p *ngIf="message">{{ message }}</p>
</div>
