
<div class="stock-table-container">
  <h2>Inventory Stock</h2>
 
  <!-- Filters -->
  <div class="inventory-filter" style="margin-bottom: 15px;">
    <input
      type="text"
      placeholder="Search products..."
      [(ngModel)]="searchText"
      (input)="onSearchChange()"
      style="padding: 5px; margin-right: 10px;"
    />
 
    <select
      [(ngModel)]="selectedCategoryId"
      (change)="filterByCategory(+selectedCategoryId)"
      style="padding: 5px;"
    >
      <option value="0">All Categories</option>
      <option *ngFor="let cat of allCategories" [value]="cat.categoriesId">
        {{ cat.categoryName }}
      </option>
    </select>
  </div>
 
  <!-- Product Table -->
  <table>
    <thead>
      <tr>
        <th>Product ID</th>
        <th>Product Name</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Min Threshold</th>
        <th>Max Threshold</th>
        <th>Alert</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of products">
        <td>{{ product.productsId }}</td>
        <td>{{ product.productsName }}</td>
        <td>{{ product.productsUnitPrice | currency:'INR' }}</td>
        <td>{{ product.productsQuantity }}</td>
 
        <!-- Inline editing
        <td>
          <ng-container *ngIf="editingProductId === product.productsId; else viewMin">
            <input type="number" [(ngModel)]="product.minStockThreshold" class="threshold-input"/>
          </ng-container>
          <ng-template #viewMin>
            {{ product.minStockThreshold || '-' }}
          </ng-template>
        </td>
 
        <td>
          <ng-container *ngIf="editingProductId === product.productsId; else viewMax">
            <input type="number" [(ngModel)]="product.maxStockThreshold" class="threshold-input"/>
          </ng-container>
          <ng-template #viewMax>
            {{ product.maxStockThreshold || '-' }}
          </ng-template>
        </td>-->
 
        <td>
  <ng-container *ngIf="editingProductId === product.productsId; else viewMin">
    <input
      type="number"
      [(ngModel)]="product.minStockThreshold"
      [max]="product.maxStockThreshold ?? null"
      min="0"
      class="threshold-input"
    />
  </ng-container>
  <ng-template #viewMin>
    {{ product.minStockThreshold ?? '-' }}
  </ng-template>
</td>
 
<td>
  <ng-container *ngIf="editingProductId === product.productsId; else viewMax">
    <input
      type="number"
      [(ngModel)]="product.maxStockThreshold"
      [min]="product.minStockThreshold ?? 0"
      min="0"
      class="threshold-input"
    />
  </ng-container>
  <ng-template #viewMax>
    {{ product.maxStockThreshold ?? '-' }}
  </ng-template>
</td>
 
 
        <td>
          <span
            [ngStyle]="{
              'color': isBelowThreshold(product) ? 'red' : 'green',
              'font-weight': 'bold'
            }"
          >
            {{ isBelowThreshold(product) ? 'LOW STOCK' : 'AVAILABLE' }}
          </span>
        </td>
 
        <td>
          <ng-container *ngIf="editingProductId === product.productsId; else editButton">
            <button (click)="saveThresholds()">Save</button>
            <button (click)="cancelEdit()">Cancel</button>
          </ng-container>
          <ng-template #editButton>
            <button (click)="startEdit(product.productsId)">Edit</button>
          </ng-template>
        </td>
      </tr>
    </tbody>
  </table>
</div>
 
 
 